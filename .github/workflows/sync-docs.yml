name: Sync docs

on:
  workflow_dispatch:  # Allow manual trigger
  schedule:
    - cron: '0 6 * * *'  # Runs daily at 6 AM UTC

jobs:
  sync-docs:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repo kamui-kazi.github.io (testing branch)
        uses: actions/checkout@v3
        with:
          ref: testing
          token: ${{ secrets.PAT_TOKEN }}

      - name: Clone repo Shoutout-Raid
        run: git clone --depth 1 https://github.com/Kamui-Kazi/Shoutout-Raid.git Shoutout-clone

      - name: Clone repo Redeem-Counter
        run: git clone --depth 1 https://github.com/Kamui-Kazi/Redeem-Counter.git Redeem-clone

      - name: Replace docs from repos Shoutout-Raid and Redeem-Counter
        run: |
          rm -rf docs
          mkdir -p docs docs/Shoutout-Raid docs/Redeem-Counter
          cp -r Shoutout-clone/docs/ docs/Shoutout-Raid
          cp -r Redeem-clone/docs/* docs/Redeem-Counter 

      - name: Commit and push changes
        run: |
          git config user.name "github-actions"
          git config user.email "actions@github.com"
          git add docs/
          git diff --cached --quiet || git commit -m "Update docs from repos Shoutout-Raid and Redeem-Counter"
          git push origin testing
